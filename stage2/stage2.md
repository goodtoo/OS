# 操作系统开发项目报告（第二阶段）

## 一、项目目标

在第一阶段基础上，本阶段目标是完成从实模往保护模式的切换，创建全局描述符表 GDT，并在保护模式中通过直接写入显展缓冲的方式输出字符串，验证保护模式切换成功。

## 二、组件构成

- **boot.asm**：实现引导程序，初始化系统和 GDT，调用 CR0 切换到 32 位保护模式，并输出字符。
- **Makefile**：编译 boot.asm 为 boot.bin，并打包成 os-image 启动镜像
- **os-image**：由 boot.bin 生成，作为 QEMU 模拟启动的文件

## 三、技术实现细节

### 1. GDT 初始化

- 创建 GDT 表：包含空描述符、代码段描述符和数据段描述符
- 创建 GDTR 输入到 CPU：使用 `lgdt [gdt_descriptor]`

### 2. 切换保护模式

- 通过设置 CR0 第 0 位，启用 PE (Protection Enable)
- 通过转移跳转到代码段的 selector，启动 32 位代码执行

### 3. 字符显示输出

- 禁用 BIOS 中断，改用直接写入显展缓冲地址 `0xB8000`
- 对于每个字符：写入字符编码和色值，输出 `Entered Protected Mode!`

## 四、运行效果

![3572de6d061259184d725892a6b1243](D:\Github\OS\stage2\1749135908128.jpg)

- BIOS 进入后，直接显示字符串：

  ```
  Entered Protected Mode!
  ```

- 说明系统已成功切入保护模式，并能按字节写入显展缓冲

## 五、意义

- 创建了 x86 系统核心的内核环境
- 为 IDT 中断、键盘输入、项目分模块化实现托定基础

## 六、后续计划

第三阶段将扩展系统功能，包括：

- IDT 中断设置，添加默认异常处理
- 接入键盘输入，实现字符显示
- 而后分离 C 版本 kernel.c ，实现 C 和 asm 添加调用